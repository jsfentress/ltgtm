---
import BaseLayout from '../layouts/BaseLayout.astro';
import Section from '../components/Section.astro';
import Hero from '../components/Hero.astro';
import Header from '../components/Header.astro';
import Form from '../components/Form.astro';
import Footer from '../components/Footer.astro';
import { getCollection } from 'astro:content';

// Get all sections and sort by order
const sections = await getCollection('sections');
const sortedSections = sections.sort((a, b) => a.data.order - b.data.order);

// Get hero section (order 1)
const heroSection = sortedSections.find(s => s.data.order === 1);

// Get content sections (orders 2+)
const contentSections = sortedSections.filter(s => s.data.order > 1);
---

<BaseLayout
  title="Lead Time GTM - Right Time, Relevant Conversations"
  description="Lead Time GTM helps your team reach out when something real has changed inside an account."
>
  <Header />

  <main id="main-content">
    {heroSection && (
      <Hero
        title={heroSection.data.title || ''}
        subtitle={heroSection.data.subtitle || ''}
        checkmarks={heroSection.data.checkmarks || []}
      />
    )}

    {contentSections.map((section) => (
      <Section section={section} />
    ))}

    <Form />
  </main>

  <Footer />
</BaseLayout>
