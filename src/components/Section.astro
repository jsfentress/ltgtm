---
import type { CollectionEntry } from 'astro:content';

interface Props {
  section: CollectionEntry<'sections'>;
}

const { section } = Astro.props;
const { data, render } = section;

const sectionId = `section-${data.order}`;
const animationClass = data.animation === 'none' ? '' : `scroll-${data.animation}`;

// Determine layout variant based on section order
// All sections left-aligned to match form style
const isHero = data.order === 1;
const isFirstContentSection = data.order === 2;
const layoutClass = 'items-start text-left';
const containerClass = 'max-w-[800px]';

// Render the MDX content
const { Content } = await render();
---

<section
  id={sectionId}
  data-section
  class={`flex flex-col justify-center px-6 md:px-12 ${isFirstContentSection ? 'pt-24 md:pt-32 pb-10 md:pb-14' : 'py-10 md:py-14'} ${animationClass}`}
  style="transform: translate3d(0, 0, 0);"
>
  <div class={`w-full mx-auto ${containerClass}`}>
    <div class={layoutClass}>
      {data.subtitle && data.subtitle.trim() !== '' && (
        <p class="section-subtitle mb-6">
          {data.subtitle}
        </p>
      )}
      
      {data.media && data.media.position === 'top' && (
        <div class="hero-modern">
          <!-- Background image -->
          <div
            class="hero-background-modern"
            style={`background-image: url('${data.media.src}');`}
          ></div>

          <!-- Subtle overlay for text readability -->
          <div class="hero-overlay-modern"></div>

          <!-- Hero content -->
          <div class="hero-content-modern">
            <div class="hero-text-wrapper">
              <!-- Main heading -->
              <h1 class="hero-title-modern">
                {data.title}
              </h1>

              <!-- Content -->
              <div class="hero-body-modern">
                <Content />
              </div>

              <!-- CTA Button -->
              {data.cta && (
                <div class="hero-cta-modern">
                {data.cta.type === 'form' && (
                  <a
                    href="#contact"
                    class="btn btn-primary btn-lg"
                  >
                    <span>{data.cta.text}</span>
                    <svg class="w-5 h-5 icon-right" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6" />
                    </svg>
                  </a>
                )}

                {data.cta.type === 'external' && data.cta.href && (
                  <a
                    href={data.cta.href}
                    target="_blank"
                    rel="noopener noreferrer"
                    class="btn btn-primary btn-lg"
                  >
                    <span>{data.cta.text}</span>
                    <svg class="w-5 h-5 icon-right" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                    </svg>
                  </a>
                )}

                {data.cta.type === 'scroll' && (
                  <button
                    data-scroll-next
                    class="btn btn-primary btn-lg"
                  >
                    <span>{data.cta.text}</span>
                    <svg class="w-5 h-5 icon-down" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                  </button>
                )}
                </div>
              )}
            </div>
          </div>
        </div>
      )}
      
      {!data.media && (
        <>
          <h2 class="section-title mb-8">
            {data.title}
          </h2>

          <div class="prose max-w-3xl">
            <Content />
          </div>
        </>
      )}
    
      {data.cta && !data.media && (
        <div class="mt-16">
                  {data.cta.type === 'form' && (
                    <a
                      href="#contact"
                      class="btn btn-primary btn-lg"
                    >
                      <span>{data.cta.text}</span>
                      <svg class="w-5 h-5 icon-right" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6" />
                      </svg>
                    </a>
                  )}

                  {data.cta.type === 'external' && data.cta.href && (
                    <a
                      href={data.cta.href}
                      target="_blank"
                      rel="noopener noreferrer"
                      class="btn btn-primary btn-lg"
                    >
                      <span>{data.cta.text}</span>
                      <svg class="w-5 h-5 icon-right" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                      </svg>
                    </a>
                  )}

                  {data.cta.type === 'scroll' && (
                    <button
                      data-scroll-next
                      class="btn btn-primary btn-lg"
                    >
                      <span>{data.cta.text}</span>
                      <svg class="w-5 h-5 icon-down" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                      </svg>
                    </button>
                  )}
        </div>
      )}
    </div>
  </div>
</section>

